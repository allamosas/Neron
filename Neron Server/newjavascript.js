/* SPT */!function(t, e){"object" == typeof exports && "object" == typeof module?module.exports = e():"function" == typeof define && define.amd?define([], e):"object" == typeof exports?exports.AutoTrack = e():t.AutoTrack = e()}(this, function(){return function(t){function e(o){if (i[o])return i[o].exports; var n = i[o] = {exports:{}, id:o, loaded:!1}; return t[o].call(n.exports, n, n.exports, e), n.loaded = !0, n.exports}var i = {}; return e.m = t, e.c = i, e.p = "", e(0)}([function(t, e, i){"use strict"; function o(){var t = decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*" + encodeURIComponent("_pulse2debug").replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=\\s*([^;]*).*$)|^.*$"), "$1")) || !1; return t}var n, r = {}, s = i(1), a = i(2), c = {}, d = !1; try{c = i(!function(){var t = new Error('Cannot find module "../lib/vars"'); throw t.code = "MODULE_NOT_FOUND", t}())} catch (u){c = i(17)}o() && (d = !0), "undefined" != typeof pulse2opt?r = pulse2opt:"undefined" != typeof _opt?r = _opt:d && console.log("init.js: Could not find pulse2opt global variable"), r.debugMode = d; try{n = r.cookieSyncUrl || c.envVars.cookieSyncUrl, a.initTracking(r), n && s.initCookieSync({url:n, userId:r.userId})} catch (u){d && console.log("init.js: Pulse2 init failed: " + u)}t.exports = a}, function(t, e){"use strict"; function i(t){var e = new Image, i = t.url + "?r=" + Math.random(); t.userId && (i += "&id=" + t.userId), e.src = i}t.exports.initCookieSync = i}, function(t, e, i){"use strict"; function o(t){var e, o, n, r; t = t || {}, e = i(3), t.pageLoad !== !1 && e.pageLoad(s), t.hashChange === !0 && e.hashChange(s), t.pageUnload === !0 && e.pageUnload(s), o = i(4), t.clickButton === !0 && o.button(s), n = i(5), t.engagement === !0 && n.engagement(s), r = i(6), t.relativeScroll === !0 && r.trackScrollRelative(s, 25), t.itemVisible === !0 && r.trackScrollItems(s)}function n(t){var e = i(7); a !== !0 && (a = !0, o(t.trackingFeatures), e.impliedEvents(s))}function r(t){var e, o = t.throttle || 1; return Math.random() < o?(e = i(8), s = new e(t), "complete" === document.readyState || "interactive" === document.readyState?n(t):(window.addEventListener("DOMContentLoaded", function(){n(t)}, !1), window.addEventListener("load", function(){n(t)}, !1)), s.getPageViewId()):void 0}var s = {}, a = !1; t.exports.initTracking = function(t){r(t)}, t.exports.getPageViewId = function(){return s.getPageViewId()}, t.exports.logoutEvent = function(){s.userLogout()}, t.exports.loginEvent = function(t){s.userLogin(t)}, t.exports.activity = function(){return s}}, function(t, e){"use strict"; t.exports.pageLoad = function(t){t.events.trackContentView().send()}, t.exports.hashChange = function(t){document.addEventListener("hashchange", function(){t.events.trackContentView().send()}, !1)}, t.exports.pageUnload = function(t){var e = t.utils.utils.dateNow(), i = !1; document.addEventListener("click", function(o){var n, r, s, a; i && (i = !0, n = o.target, "a" === n.tagName.toLowerCase() && (r = n.getAttribute("href"), s = /^https?:\/\//i, r.match(s) && (t.events.trackEngagementTime(t.utils.utils.dateNow() - e).queue(), a = t.events.trackExit("urn:exit:" + r, "Page"), a.addProperty("secondary", "url", r), a.queue(), t.sendQueue())))}, !1), window.addEventListener("beforeunload", function(){i || (i = !0, t.events.trackEngagementTime(t.utils.utils.dateNow() - e).queue(), t.events.trackExit().queue(), t.sendQueue())}), window.addEventListener("unload", function(){i || (i = !0, t.events.trackEngagementTime(t.utils.utils.dateNow() - e).queue(), t.events.trackExit().queue(), t.sendQueue())}, !1)}}, function(t, e){"use strict"; t.exports.button = function(t){document.addEventListener("click", function(e){var i = e.target || e.srcElement; /.*track-click.*/.test(i.className) && t.events.trackClick(i.id).send()}, !1)}}, function(t, e){"use strict"; t.exports.engagement = function(t){document.addEventListener("click", function(e){var i = e.target || e.srcElement; /.*track-engagement.*/.test(i.className) && t.events.trackEngagement(t.utils.getViewDuration(), t.utils.getScrollPosition(), "Click", i.tagName, i.id, i.getAttribute("p2-action"), i.getAttribute("p2-meta")).send()}, !1)}}, function(t, e){"use strict"; t.exports.trackScrollRelative = function(t, e){var i = 0; document.addEventListener("scroll", function(){var o = document.getElementsByTagName("body")[0], n = o.scrollTop / (o.offsetHeight - window.innerHeight) * 100; n - i > 1.5 * e && (i = Math.floor(n / e) * e), n >= i + e?(i += e, t.events.trackScroll(i, "Arrive").send(), i > 100 && (i = 100)):i - e >= n && (i -= e, t.events.trackScroll(i, "Arrive").send(), i > 100 && (i = 100))}, !1)}, t.exports.trackScrollItems = function(t){function e(t){for (var e = t.offsetTop, i = t.offsetLeft, o = t.offsetWidth, n = t.offsetHeight; t.offsetParent; )t = t.offsetParent, e += t.offsetTop, i += t.offsetLeft; return e < window.pageYOffset + window.innerHeight && i < window.pageXOffset + window.innerWidth && e + n > window.pageYOffset && i + o > window.pageXOffset}var i, o, n, r = [], s = document.getElementsByTagName("*"); for (n = 0; n < s.length; n++)(" " + s[n].className + " ").indexOf(" track-visibility ") > - 1 && r.push({element:s[n], visible:!1}); document.addEventListener("scroll", function(){for (n = 0; n < r.length; n++)i = r[n], e(i.element) !== i.visible && (i.visible === !1?(i.visible = !0, i.timeStart = t.utils.getTimestamp(), t.events.trackVisibility(i.element.id, i.timeStart).send()):i.visible === !0 && (i.visible = !1, o = {start:i.timeStart, end:t.utils.getTimestamp()}, t.events.trackVisibility(i.element.id, o).send(), i.timeStart = null))}, !1)}}, function(t, e){"use strict"; t.exports.impliedEvents = function(t){function e(t, e, i){return t[e]?t[e]:i}var i = t.opts.impliedEvents; i && i.map(function(i){var o; switch (o = i.params, i.track.toLowerCase()){case"create":t.events.trackCreate(e(o, 0), e(o, 1), e(o, 2, {})).send(); break; case"login":t.events.trackLogin(e(o, 0), e(o, 1), e(o, 2, {})).send(); break; case"logout":t.events.trackLogout(e(o, 0), e(o, 1), e(o, 2, {})).send(); break; case"reply":t.events.trackReply(e(o, 0), e(o, 1), e(o, 2, {})).send(); break; case"update":t.events.trackUpdate(e(o, 0), e(o, 1), e(o, 2, {})).send()}})}}, function(t, e, i){"use strict"; function o(t){if (this.pulse2timing = {init:a.dateNow()}, t && !t.optOut){if (this.optOut = !1, this.waitForOptOut = !1, t.waitForOptOut && (this.optOut = "wait", this.waitForOptOut = !0), !t.clientId)throw new Error("clientId is required"); this.vars = r, this.version = g, this.clientId = ("urn:schibsted.com:" + t.clientId).toLowerCase(), t.url?(this.url = t.url + "/" + this.clientId, this.pixelUrl = t.url):(this.url = this.vars.envVars.dataCollectorUrl + "/" + this.clientId, this.pixelUrl = this.vars.envVars.dataCollectorUrl), this.pageViewId = a.getUuidV4(), this.pixel = new d(this.pixelUrl, "pulse2", t.pixelThrottle), this.pixel.initPulsePixel(this.pageViewId, this.clientId), this.pulse2timing = {pixelDone:a.dateNow()}, t.transport?this.transport = t.transport:this.transport = new u, t.respectDoNotTrack === !0 && navigator && 1 === navigator.doNotTrack?this.allowTracking = !1:this.allowTracking = !0, this.opts = t, this.contentId = t.contentId || t.pageId || encodeURIComponent(document.location), this.contentType = t.contentType || t.pageType || "Content", this.userIdDomain = t.userIdDomain, this.noRedirect = !0, this.utils = a, this.enrichmentFailed = !1, this.queue = new h(100), this.opts.localCookieNotSet = !1, this.events = new s(this), this.user = new c({userId:this.opts.userId, userIdDomain:this.opts.userIdDomain, userServiceUrl:this.opts.userServiceUrl, noRedirect:this.noRedirect, transport:this.transport, utils:this.utils, waitForOptOut:this.waitForOptOut}), this.plugins = new p(this.opts), this.trigger = new l(this), this.initIds(function(){}), this.plugins.call(this.plugins.sdkLoad, this)}}var n = i(9)("spt:pulse"), r = {}, s = i(10), a = i(13), c = i(14), d = i(18), u = i(15), h = i(19), p = i(20), l = i(21), g = "2.4.8"; try{r = i(16)} catch (f){r = i(17)}o.prototype.initIds = function(t){var e = this; t = t || function(){}, n("Fetching Ids"), this.pulse2timing.fetchIds = a.dateNow(), this.user.getUserId(function(i, o){e.idsDoneCallback(i, o, t), e.plugins.call(e.plugins.sdkReady, e)})}, o.prototype.idsDoneCallback = function(t, e, i){return t?(n("Failed to fetch ids from CIS", t), delete this.envId):(this.userId || (this.userId = e.userId), this.envId = e.envId), this.pulse2timing.receivedIds = a.dateNow(), this.waitingToTransmitQueue === !0 && (this.sendQueue(), this.waitingToTransmitQueue = !1), this.doPixelSync(), i(e)}, o.prototype.doPixelSync = function(){var t, e = "https://secure.adnxs.com/getuid?https://cis.schibsted.com/api/v1/sync?ANID=$UID"; this.user.shouldSyncWithAn && (this.user.shouldSyncWithAn = !1, this.user.setAnIdUnresolved(), t = new d(e, "pulse2an", 1), t.initPixel())}, o.prototype.sendQueue = function(t){var e, i, o = this; if (t = t || function(){}, !this.queue.count())return t("no items in queue"); if (!this.allowTracking)return t("tracking not allowed"); if (this.plugins.call(this.plugins.eventCreated, this.queue.peekAll()), "send" !== this.isUserInfoResolved() || "send" !== this.optOutAction())return this.waitingToTransmitQueue = !0, t("not ready to send"); for (n("Sending queue"), i = this.queue.pullAll(), e = 0; e < i.length; e++)this.enrichEvents(i[e]); this.enrichmentFailed || (this.plugins.call(this.plugins.eventReady, i), this.transport.post(this.url, i, function(e){e?(n("Failed to send queue"), o.queue.pushMany(i), t(e)):(o.plugins.call(o.plugins.eventSent, i), t(null, !0))}))}, o.prototype.send = function(t, e){var i = this; return e || (e = function(){}), this.allowTracking?(this.plugins.call(this.plugins.eventCreated, t), "send" !== this.isUserInfoResolved() || "send" !== this.optOutAction()?(this.queue.push(t), this.waitingToTransmitQueue = !0, e("not ready to send")):(n("Sending object"), this.enrichEvents(t), void(this.enrichmentFailed || (this.plugins.call(this.plugins.eventReady, t), this.transport.post(this.url, [t], function(o){o?(n("Failed to send object"), i.queue.push(t), e(o)):(i.plugins.call(i.plugins.eventSent, t), e(null, !0))}))))):e("tracking not allowed")}, o.prototype.optOutAction = function(){return this.waitForOptOut && "wait" === this.optOut?"wait":this.waitForOptOut && this.optOut?"discard":"send"}, o.prototype.setOptOut = function(t, e){return this.optOut = t, this.waitingToTransmitQueue === !0 && (this.waitingToTransmitQueue = !1), this.sendQueue(e)}, o.prototype.isUserInfoResolved = function(){return"undefined" == typeof this.envId?"SDK: Waiting for envId":this.envId.indexOf("undefined") > - 1?(delete this.envId, "SDK: Waiting for envId"):this.user.doTracking === !1?"CIS: user has opted out":"send"}, o.prototype.enrichEvents = function(t){this.addTheIds(t), t.tracker.performance && (t.tracker.performance.pulse2.sendEvents = a.dateNow()), this.user && this.user.localCookieNotSet && (t.tracker.localCookieNotSet = !0)}, o.prototype.addTheIds = function(t){var e = this.user.getTheEnvironmentId(), i = this.user.getTheUserId(), o = this.user.getTheJweIds(); if (t.actor && e && "undefined" !== e){if (0 !== String(e).indexOf("urn:")){if (e.length > 40)return void this.deleteEnvId(); t.actor["@id"] = "urn:schibsted.com:environment:" + e, t.actor["spt:environmentId"] = "urn:schibsted.com:environment:" + e} else{if (e.length > 70)return void this.deleteEnvId(); t.actor["@id"] = e, t.actor["spt:environmentId"] = e}o && (t.device.jweIds = o), t.actor["spt:userId"] = i}}, o.prototype.deleteEnvId = function(){this.enrichmentFailed = !0, delete this.user.idObj.envId, this.refreshUserIds()}, o.prototype.getPageViewId = function(){return this.pageViewId}, o.prototype.getSessionId = function(){this.opts.debugMode && console.log("activity.js: Deprecated: getSessionId")}, o.prototype.userLogout = function(){delete this.user.idObj.userId, this.refreshUserIds()}, o.prototype.userLogin = function(t){this.user.idObj.userId = t, this.refreshUserIds()}, o.prototype.refreshUserIds = function(){this.waitingToTransmitQueue = !0, this.initIds()}, t.exports = o}, function(t, e){"use strict"; t.exports = function(){return function(){}}}, function(t, e, i){"use strict"; function o(t){if (!t)throw new Error("activity required"); this.activity = t, this.opts = t.opts, this.contentId = t.contentId, this.contentType = t.contentType}var n = i(11), r = i(12), s = i(13); o.prototype.trackContentView = function(t){var e = new r(this.activity); return e.type = "View", e.object = this.addPageStandards(e.object), e.object.name = t || document.title, e.object.displayName = e.object.name, e.object.properties = {}, e.object.properties = this.reMapCustom(e.object.properties, "@type"), e.object.properties = this.reMapCustom(e.object.properties, "action"), e.object.properties = this.reMapCustom(e.object.properties, "item"), this.opts.filters && (e.object.filters = this.opts.filters), document.referrer && (e.origin = {url:document.referrer}), this.opts.targetId && this.opts.targetType && (e.target = {}, e.target = this.addPageStandards(e.target, this.opts.targetId, this.opts.targetType)), this.opts.contentType && ("classifiedad" === this.opts.contentType.toLowerCase() && (e.schema.schema = "http://schema.schibsted.com/events/ad-view-event.json/27.json#"), "listing" === this.opts.contentType.toLowerCase() && (e.schema.schema = "http://schema.schibsted.com/events/search-result-list-view.json/31.json#")), new n(e, ["object", "origin"])}, o.prototype.trackBasic = function(t, e, i, o){var s = new r(this.activity); return e = e || "Content", i = i || "undefined", s.id = this.getUrnIdWithContentType(i, e), s.type = t || "View", "object" == typeof o?s.addCustomDataToProperty(s.object, o):s.activity.opts.debugMode && console.log("events.js:trackBasic: objectMeta must be an object"), s.object["@id"] = this.getUrnIdWithContentType(i, e), s.object["@type"] = e, s.origin = this.addPageStandards(s.origin), new n(s, ["object", "origin"])}, o.prototype.trackCreate = function(t, e, i){return this.trackBasic("Create", t, e, i)}, o.prototype.trackUpdate = function(t, e, i){return this.trackBasic("Update", t, e, i)}, o.prototype.trackReply = function(t, e, i){var o = new r(this.activity); return t = t || "Content", e = e || this.opts.contentId, o.id = this.getUrnIdWithContentType(e, t), o.type = "Send", o.addCustomDataToProperty(o.object, i), o.object["@type"] = t, o.origin = this.addPageStandards(o.origin), new n(o, ["object", "origin"])}, o.prototype.trackLogin = function(t, e, i){return this.trackBasic("Login", t, e, i)}, o.prototype.trackLogout = function(t, e, i){return this.trackBasic("Logout", t, e, i)}, o.prototype.trackClick = function(t, e, i, o, s){var a = new r(this.activity); return a.type = s || "Accept", a.object["@id"] = this.getUrnIdWithContentType(o, i) + ":element:" + t, a.object["@type"] = "Link", a.object.name = e, a.object.displayName = e, a.schema.target = {"@id":this.getUrnIdWithContentType(o, i), "@type":i}, new n(a, ["object", "target"])}, o.prototype.trackSocial = function(t, e, i){var o = new r(this.activity); return o.type = i || "Like", o.origin = this.addPageStandards(o.origin), o.object["@id"] = this.getUrnIdWithContentType() + ":element:" + t, o.object["@type"] = "Link", o.schema.target = {"@id":"urn:" + e.toLowerCase() + ":action:" + o.type.toLowerCase(), "@type":"Service"}, new n(o, ["object", "origin", "target"])}, o.prototype.trackMediaState = function(t, e, i){var o = new r(this.activity); return o.type = i || "Watch", o.object = {"@type":e, "@id":this.getUrnIdWithContentType() + ":" + e + ":" + t}, o.origin = this.addPageStandards(o.origin), new n(o, ["object", "origin"])}, o.prototype.trackScroll = function(t, e){var i = new r(this.activity); return i.type = e || "Arrive", i.object = this.addPageStandards(i.object), i.schema.result = {"@type":"Place", "@id":this.getUrnIdWithContentType() + ":scroll:" + t, "spt:depth":t}, new n(i, ["object", "result"])}, o.prototype.trackVisibility = function(t, e, i){var o = new r(this.activity); if ("undefined" == typeof e)throw new Error("No time parameter was passed to this function"); return o.type = i || "View", o.origin = this.addPageStandards(o.origin), o.object = {"@type":"Content", "@id":this.getUrnIdWithContentType() + ":element:" + t}, e.start?o.object.startTime = e.start:e && !e.end && (o.object.startTime = e), e.end && (o.object.endTime = e.end), new n(o, ["origin", "object"])}, o.prototype.trackExit = function(t, e, i){var o = new r(this.activity); return o.type = i || "Leave", o.object = this.addPageStandards(o.object), o.schema.target = {}, "undefined" != typeof t && "undefined" != typeof e && (o.schema.target = {"@type":e, "@id":this.getUrnIdWithContentType(t, e)}), new n(o, ["object", "target"])}, o.prototype.trackEngagement = function(t, e, i, o, s, a, c){var d, u = new r(this.activity); if (u.schema.schema = "http://schema.schibsted.com/events/engagement-event.json/16.json#", u.type = "Engagement", u.origin = this.addPageStandards(u.origin), c){if (d = c, "string" == typeof c)try{d = JSON.parse(c)} catch (h){u.activity.opts.debugMode && console.log("Error parsing JSON: " + h)}"object" == typeof d && u.addCustomDataToProperty(u.object, d)}return o && s?(u.object["@id"] = u.origin["@id"] + ":" + o + ":" + s, u.object["@type"] = o, u.object.action = a):u.object = this.addPageStandards(u.object), t || 0 === t?u.schema.duration = t:u.schema.duration = this.activity.utils.getViewDuration(), e || 0 === e?u.schema.scrollPosition = e:u.schema.scrollPosition = this.activity.utils.getScrollPosition(), u.schema.action = i, new n(u, ["object"])}, o.prototype.trackEngagementTime = function(t, e, i){return this.trackEngagement(t, i)}, o.prototype.trackCustomEvent = function(t, e, i){var o = new r(this.activity); return o.type = e || "Custom", o.object = this.addPageStandards(o.object), "object" == typeof i && o.addCustomDataToProperty(o.object["spt:custom"], i), t && (o.provider.eventIdentifier = t), new n(o, ["object"])}, o.prototype.trackCustom = function(t, e){var i = new r(this.activity); return i.type = t && !~t.indexOf("custom:")?"custom:".concat(t):t || "custom:Content", i.object = this.addPageStandards(i.object), i.schema.schema = "http://schema.schibsted.com/events/custom-event.json/0.json#", "object" == typeof e && (i.custom = e), new n(i, ["object"])}, o.prototype.addPageStandards = function(t, e, i){return e = e || this.activity.contentId, i = i || this.activity.contentType, t = t || {}, t["@type"] = i, String(this.activity.contentId).indexOf("urn:") > - 1?t["@id"] = e:t["@id"] = this.getUrnIdWithContentType(e, i), t.url = document.URL, t.name = document.title, t.displayName = document.title, this.opts.inLanguage && (t.inLanguage = this.opts.inLanguage), this.opts.tags && s.isArray(this.opts.tags) && (t.tags = this.opts.tags), this.validateAndSet(t, "adType", this.opts.adType, "string"), this.validateAndSet(t, "location", this.opts.contentLocation, "object"), this.validateAndSet(t, "publisher", this.opts.publisher, "object"), this.validateAndSet(t, "publisherType", this.opts.publisherType, "object"), this.validateAndSet(t, "images", this.opts.images, "object"), this.validateAndSet(t, "published", this.opts.published, "string"), this.validateAndSet(t, "price", this.opts.price), this.validateAndSet(t, "currency", this.opts.currency, "string"), this.validateAndSet(t, "items", this.opts.items, "object"), this.addCategoryToEvents(t)}, o.prototype.validateAndSet = function(t, e, i, o){return e && i?o && typeof i !== o?(console.log("not valid" + e + " : " + o), void(this.activity.opts.debugMode && console.log(e + " is not of type " + o))):void(t[e] = i):void 0}, o.prototype.addCategoryToEvents = function(t){var e = this.activity.opts, i = ""; return e.provider = e.provider || {}, e.object = e.object || {}, e.category?i = e.category:e.object.category?i = e.object.category:e.provider.category && (i = e.provider.category), s.isArray(i) && (i = i.toString()), i && (t.category = i), t}, o.prototype.getUrnIdWithContentType = function(t, e){var i, o, n = t || this.activity.contentId; return - 1 === String(n).indexOf("urn:")?(i = e || this.activity.contentType, o = this.getDomainFromUrl(document.URL), "urn:" + o + ":" + i.toLowerCase() + ":" + n):n}, o.prototype.getDomainFromUrl = function(t){var e = t.match(/^https?\:\/\/(www.)?([^\/:?#]+)(?:[\/:?#]|$)/i); return e && e[2]}, o.prototype.reMapCustom = function(t, e, i){return i !== !1 && (i = !0), this.opts.object && this.opts.object.properties && this.opts.object.properties[e]?(t[e] = this.opts.object.properties[e], i && delete this.opts.object.properties[e], t):t}, t.exports = o}, function(t, e){"use strict"; function i(t, e){if (!t)throw new Error("data required"); try{this.data = t.getSchema()} catch (i){throw new Error("get schema function required")}if (!t.activity)throw new Error("data must have property activity"); this.activity = t.activity, this.objectOrder = e || []}i.prototype.queue = function(){this.activity.queue.push(this.data)}, i.prototype.send = function(t){this.activity.send(this.data, t)}, i.prototype.addProperty = function(t, e, i){var o = this.getObjectKey(t); return this.data[o][e] = i, this}, i.prototype.addCustomData = function(t, e){var i = this.getObjectKey(t); return this.data[i]["spt:custom"] = e, this}, i.prototype.getObjectKey = function(t){if ("primary" === t)return this.objectOrder[0]; if ("secondary" === t)return this.objectOrder[1]; if ("tertiary" === t)return this.objectOrder[2]; throw new Error("Object reference not valid")}, t.exports = i}, function(t, e, i){"use strict"; function o(t, e){if (!t)throw new Error("Activity needed"); this.activity = t, this.reducedEvent = e, this.schema = {}, this.type = null, this.actor = {}, this.device = {}, this.provider = {}, this.object = {}, this.origin = {}, this.location = {}, this.tracker = {}, this.initSchema()}var n = i(13); o.prototype.initSchema = function(){this.schema["@id"] = n.getUuidV4(), this.schema["spt:pageViewId"] = this.activity.pageViewId, this.schema.published = n.getTimestamp(), this.schema.schema = "http://schema.schibsted.com/events/base-event.schema.json/25.json", this.createActor(), this.createTracker(), this.createDevice(), this.createProvider(), this.createObject(), this.createOrigin(), this.createLocation(), this.addCustomData()}, o.prototype.populateSchema = function(){this.schema["@type"] = this.type, this.schema.actor = this.actor, this.schema.tracker = this.tracker, this.schema.device = this.device, this.schema.provider = this.provider, this.schema.object = this.object, this.schema.origin = this.origin, this.schema.location = this.location, this.target && (this.schema.target = this.target), this.result && (this.schema.result = this.result), this.scrollPosition && (this.schema.scrollPosition = this.scrollPosition), this.duration && (this.schema.duration = this.duration), this.custom && (this.schema.custom = this.custom)}, o.prototype.createDevice = function(){this.device.deviceType = n.getDeviceType(navigator.userAgent)}, o.prototype.createObject = function(){this.object["spt:custom"] = {}}, o.prototype.createOrigin = function(){}, o.prototype.createTracker = function(){this.tracker.version = this.activity.version, this.tracker.type = "JS", this.activity.user && this.activity.user.localCookieNotSet && (this.tracker.localCookieNotSet = !0); try{this.checkLocalStorage()} catch (t){this.tracker.localStorageNotSet = !0}this.reducedEvent || this.extendedTrackerData()}, o.prototype.extendedTrackerData = function(){this.tracker.performance = {}, this.tracker.performance.pulse2 = this.activity.pulse2timing, this.tracker.name = "Pulse v2 tracker JS SDK", window && window.performance && (this.tracker.performance.browser = {}, this.tracker.performance.browser = window.performance.timing)}, o.prototype.createLocation = function(){this.activity.opts && this.activity.opts.location && (this.location["@type"] = "Place", this.location.latitude = this.activity.opts.location.latitude, this.location.longitude = this.activity.opts.location.longitude, this.location.accuracy = this.activity.opts.location.accuracy)}, o.prototype.createActor = function(){this.actor["@type"] = "Person", this.reducedEvent || this.extendedActorData()}, o.prototype.extendedActorData = function(){this.actor["spt:userAgent"] = navigator.userAgent, this.actor["spt:screenSize"] = window.screen.width + "x" + window.screen.height, this.actor["spt:viewportSize"] = n.getViewportDimensions(), this.actor["spt:acceptLanguage"] = n.getDeviceLanguage()}, o.prototype.createProvider = function(){this.provider["@type"] = "Organization", this.provider["@id"] = this.activity.clientId, this.provider.url = document.URL}, o.prototype.addCustomData = function(){this.activity.opts && (this.addCustomDataToProperty(this.provider, this.activity.opts.provider), this.addCustomDataToProperty(this.object["spt:custom"], this.activity.opts.object))}, o.prototype.addCustomDataToProperty = function(t, e){var i; for (i in e)t.hasOwnProperty(i) || (t[i] = e[i])}, o.prototype.getSchema = function(){return this.populateSchema(), this.schema}, o.prototype.getString = function(){return JSON.stringify(this.getSchema())}, o.prototype.checkLocalStorage = function(){localStorage.setItem("pulse2-val", "check"), localStorage.removeItem("pulse2-val")}, t.exports = o}, function(t, e){"use strict"; t.exports.retry = function(t, e, i){var o, n = 1; if (!t || "number" != typeof t)throw new Error("times required"); if (!e || "function" != typeof e)throw new Error("task required"); if (!i || "function" != typeof i)throw new Error("callback required"); o = function(){arguments[0] && n >= t?i.apply(null, arguments):arguments[0]?(n += 1, e(o)):i.apply(null, arguments)}, e(o)}, t.exports.getViewportDimensions = function(){var t, e; return"undefined" != typeof window.innerWidth?(t = window.innerWidth, e = window.innerHeight):"undefined" != typeof document.documentElement.clientWidth && 0 !== document.documentElement.clientWidth?(t = document.documentElement.clientWidth, e = document.documentElement.clientHeight):(t = document.getElementsByTagName("body")[0].clientWidth, e = document.getElementsByTagName("body")[0].clientHeight), t + "x" + e}, t.exports.getDeviceLanguage = function(){var t; return navigator.userLanguage?t = navigator.userLanguage:navigator.language && (t = navigator.language), t}, t.exports.getDeviceType = function(t){var e = {mobile:["iPhone;", "iPod;", "iPod touch;", "^HTC", "Fennec", "IEMobile", "BB10;", "BlackBerry", "SymbianOS.*AppleWebKit", "^Mozilla.*Mobile.*Firefox", "^Mozilla.*Chrome.*Mobile", "Opera Mobi", "Android.*Mobile", "Android.*Mini", "Symbian", "^SonyEricsson", "^Nokia", "^SAMSUNG", "^LG"], tablet:["iPad;", "Android"]}, i = function(e){var i, o = 0; for (o; o < e.length; o++)if (i = e[o], t.match(new RegExp(i)))return!0; return!1}; if (t){if (i(e.mobile))return"mobile"; if (i(e.tablet))return"tablet"}return"desktop"}, t.exports.getTimestamp = function(){var t = new Date, e = - t.getTimezoneOffset(), i = e >= 0?"+":"-", o = function(t){var e = Math.abs(Math.floor(t)); return(10 > e?"0":"") + e}, n = t.getFullYear() + "-" + o(t.getMonth() + 1) + "-" + o(t.getDate()); return n = n + "T" + o(t.getHours()) + ":" + o(t.getMinutes()), n = n + ":" + o(t.getSeconds()), n = n + i + o(e / 60) + ":" + o(e % 60)}, t.exports.getUuidV4 = function(){var t, e, i = ""; for (e = 0; 36 > e; e++)t = 14 === e?4:19 === e?Math.floor(4 * Math.random() + 8).toString(16):8 === e || 13 === e || 18 === e || 23 === e?"-":Math.floor(16 * Math.random()).toString(16), i += t; return i}, t.exports.getUrlParams = function(t){var e, i, o = [], n = location.search, r = n.split("&"), s = new RegExp(t + "=([^&;]+?)(&|#|;|$)", "i"); for (i = 0; i < r.length; i++)e = r[i].match(s), e && o.push(e[1]); return o}, t.exports.getQueryVariable = function(t){var e, i, o, n = window.location.search.substring(1), r = n.split("&"); for (e = 0; e < r.length; e++)if (i = r[e].split("="), i[0] === t)return i[1]; for (r = n.split("&amp"), e = 0; e < r.length; e++)if (o = r[e].split("="), o[0] === t)return o[1]}, t.exports.getScrollPosition = function(){return(window.pageYOffset || document.scrollTop) - (document.clientTop || 0)}, t.exports.getViewDuration = function(){var t, e, i; if (!window.performance)return null; t = window.performance.timing.domLoading, e = (new Date).getTime(); try{i = e - t} catch (o){i = null}return i}, t.exports.checkLocalStorage = function(){localStorage.setItem("pulse2-val", "check"), localStorage.removeItem("pulse2-val")}, t.exports.isArray = function(t){return"[object Array]" === Object.prototype.toString.call(t)}, t.exports.objectKeys = function(t){var e, i, o = Object.prototype.hasOwnProperty, n = !{toString:null}.propertyIsEnumerable("toString"), r = ["toString", "toLocaleString", "valueOf", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "constructor"], s = r.length, a = []; if ("object" != typeof t && ("function" != typeof t || null === t))throw new TypeError("Object.keys called on non-object"); for (e in t)o.call(t, e) && a.push(e); if (n)for (i = 0; s > i; i++)o.call(t, r[i]) && a.push(r[i]); return a}, t.exports.dateNow = function(){return(new Date).getTime()}}, function(t, e, i){"use strict"; function o(t){t = t || {}, this.idObj = {}, this.cookieKey = "_pulse2data", this.cookiesAllowed = navigator.cookieEnabled, this.localCookieNotSet = !1, this.anonIdPlaceholder = "x", this.opts = t, this.userIdDomain = t.userIdDomain || "schibsted.com", this.userId = this.opts.userId, this.userId || (delete this.userId, delete this.opts.userId), this.visitorIdPlaceholder = "v", this.redirectString = "https://cis.schibsted.com/redirect/?redirectUrl=" + document.location, this.userServiceUrl = t.userServiceUrl || s.envVars.userServiceUrl, this.transport = t.transport || new n, this.utils = r, this.noRedirect = !0, this.doValidation = !1, this.shouldSyncWithAn = !1, this.shouldFetchFromAn = !1, this.hasCookie = !1, this.anSyncUrl = "https://secure.adnxs.com/getuidj", this.doTracking = !0, this.anSyncStatus = "nothing has happened", "undefined" != typeof t.noRedirect && (this.noRedirect = t.noRedirect)}var n = i(15), r = i(13), s = {}; try{s = i(16)} catch (a){s = i(17)}o.prototype.getUserId = function(t){var e, i = this; return t = t || function(){}, e = this.getIdsFromCookie(), this.userId && (e.userId = this.createUserIdWithUrn(this.userId)), this.mapUserData(e), !this.idObj.envId || this.userStatusHasChanged() || this.doValidation?(this.doValidation = !1, this.getIdsFromService(this.idObj, function(e, o){return i.onIdServiceResponse(e, o, t)}), void this.doAppNexusSync(null, function(){return t(null, i.idObj)})):(setTimeout(function(){i.doAppNexusSync()}, 2e3), t(null, this.idObj))}, o.prototype.mapUserData = function(t){var e, i, o = ["undefined", "false", "0", "", "null"]; this.idObj.userId = t.userId || this.idObj.userId, this.idObj.envId = t.environmentId || t.envId, this.idObj.prevUserId = t.prevUserId, this.idObj.anId = t.anId || this.idObj.anId, this.idObj.jweIds = t.jwe || this.idObj.jweIds, this.idObj.pixelInjected = t.pixelInjected || null, t.doAnSync && (this.shouldSyncWithAn = t.doAnSync), this.doTracking = this.resolveDoTracking(t.doTracking), this.idObj.userId && (e = this.idObj.userId.split(":"), i = e[e.length - 1], o.indexOf(i) >= 0 && delete this.idObj.userId), this.setIdsInCookie()}, o.prototype.setIdsInCookie = function(){var t, e, i = this.idObj.userId || this.anonIdPlaceholder, o = new Date, n = new Date, r = new Date, s = o.getTime(); this.idObj.envId && (o.setTime(s + 9e5), n.setTime(s + 144e5), r.setTime(s + 63072e6), t = [this.idObj.envId, this.visitorIdPlaceholder, i, o.getTime(), this.idObj.jweIds, this.idObj.anId, n.getTime(), this.doTracking.toString(), this.idObj.pixelInjected], this.writeCookie(t, document.domain, r.toUTCString()), e = this.getCookie(this.cookieKey), e || (this.localCookieNotSet = !0))}, o.prototype.writeCookie = function(t, e, i){var o; o = this.cookieKey + "=" + t, o += ";domain=" + e, o += ";path=/", o += ";expires=" + i, document.cookie = o}, o.prototype.getIdsFromCookie = function(){var t, e, i = this.getCookie(this.cookieKey); return i && - 1 === i.indexOf("undefined")?(t = i.split(","), t.length < 2?(this.deleteCookie(this.cookieKey), {}):(t[3] && this.utils.dateNow() > parseInt(t[3], 10) && (this.doValidation = !0, this.hasCookie = !0), t[6] && this.utils.dateNow() > parseInt(t[6], 10) && (this.shouldSyncWithAn = !0, this.doValidation = !1), t[5] && "unresolved" !== t[8] || (t[8] = "unresolved", this.shouldFetchFromAn = !0), e = {environmentId:t[0], prevUserId:t[2], jwe:t[4], anId:t[5], doTracking:t[7], pixelInjected:t[8]})):(this.deleteCookie(this.cookieKey), this.shouldSyncWithAn = !0, {})}, o.prototype.getCookie = function(t){var e = decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*" + encodeURIComponent(t).replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=\\s*([^;]*).*$)|^.*$"), "$1")) || !1; return e}, o.prototype.deleteCookie = function(t){document.cookie = t + "=;expires=Thu, 01 Jan 1970 00:00:01 GMT"}, o.prototype.getIdsFromService = function(t, e){var i = this.userServiceUrl, o = this, n = 3, r = {environmentId:t.envId, userId:t.userId, jwe:t.jweIds}; t.anId && (r.anId = t.anId), this.opts.waitForOptOut && (r.waitForOptOut = this.opts.waitForOptOut), this.hasCookie && (n = 1), this.transport.post(i, r, function(t, i){var n; t && e(t), n = JSON.parse(i.response || i.responseText), n.data.anid && "0" !== n.data.anid || (n.data.doAnSync = !0), o.mapUserData(n.data), e(null, n.data)}, !0, n)}, o.prototype.onIdServiceResponse = function(t, e, i){return this.hasCookie?(this.hasCookie = !1, i(null, this.idObj)):(t && i(t), i(null, this.idObj))}, o.prototype.userStatusHasChanged = function(){var t = this.idObj.userId, e = this.idObj.prevUserId; return e?t && e !== t.toString() || !t && e !== this.anonIdPlaceholder:!1}, o.prototype.doAppNexusSync = function(t, e){var i = this; return e = e || function(){}, this.shouldFetchFromAn?(this.shouldFetchFromAn = !1, void this.transport.get(this.anSyncUrl, null, function(t, o){var n; return t?e(t, o):(n = JSON.parse(o.response || o.responseText), i.idObj.anId = n.uid, i.mapUserData(i.idObj), i.setAnIdResolved(), i.getIdsFromService(i.idObj, function(t, o){return i.onIdServiceResponse(t, o, e)}), e())}, 1, !0)):t}, o.prototype.setAnIdUnresolved = function(){this.idObj.pixelInjected = "unresolved", this.setIdsInCookie(this.idObj)}, o.prototype.setAnIdResolved = function(){this.idObj.pixelInjected = null, this.setIdsInCookie(this.idObj)}, o.prototype.getTheUserId = function(){return this.createUserIdWithUrn(this.idObj.userId)}, o.prototype.getTheEnvironmentId = function(){return this.idObj.envId}, o.prototype.getTheJweIds = function(){return this.idObj.jweIds}, o.prototype.createUserIdWithUrn = function(t, e){return!t || String(t).indexOf("undefined") > - 1?e:String(t).indexOf("urn:") > - 1?t:"urn:" + this.userIdDomain + ":user:" + t}, o.prototype.resolveDoTracking = function(t){
return t === !0 || "true" === t || 1 === t?!0:t === !1 || "false" === t || 0 === t?!1:this.doTracking}, t.exports = o}, function(t, e, i){"use strict"; function o(){this.utils = n}var n = i(13); o.prototype.getUrlWithCorrectProtocol = function(t){var e = t.split("://"); return"//" + e.pop()}, o.prototype.getXHR = function(t, e, i){var o; return"undefined" != typeof XDomainRequest?(o = new XDomainRequest, o.open(e.toLowerCase(), this.getUrlWithCorrectProtocol(i)), o):(o = new XMLHttpRequest, "withCredentials"in o?(o.open(e, i), o.setRequestHeader("Content-Type", "application/json; charset=utf-8"), o.setRequestHeader("X-Requested-With", "XMLHttpRequest"), t && (o.withCredentials = !0), o):!1)}, o.prototype.addDataToUrl = function(t, e){var i, o; if (!e || "object" != typeof e)return t; for (i = n.objectKeys(e); i && "object" == typeof e[i[0]]; )i.shift(); for (t = this.appendParameterToUrl(t, i[0], e[i[0]], "?"), o = 1; o < i.length; o++)t = this.appendParameterToUrl(t, i[o], e[i[o]], "&"); return t}, o.prototype.appendParameterToUrl = function(t, e, i, o){return"object" != typeof i?t + o + encodeURIComponent(e) + "=" + encodeURIComponent(i):t}, o.prototype.post = function(t, e, i, o, n){return t?e && "object" == typeof e?(o = o || !1, void this.send(t, e, i, o, n, "POST")):i("data required"):i("url required")}, o.prototype.get = function(t, e, i, o, n){return t?(e && (t = this.addDataToUrl(t, e)), void this.send(t, e, i, n, o, "GET")):i("url required")}, o.prototype.send = function(t, e, i, o, n, r){var s = this; if (!i)throw new Error("callback required"); n = n || 3, this.utils.retry(n, function(i){var n = s.getXHR(o, r, t); if (n || i("Failed to identify request method"), "undefined" != typeof XDomainRequest?(n.onload = function(){i(null, n)}, n.onprogress = function(){}, n.onerror = function(){i("Failed request"), n.abort()}, n.ontimeout = n.onerror):n.onreadystatechange = function(){4 === n.readyState && (200 === n.status?i(null, n):i("Failed with status " + n.status))}, "POST" === r)try{n.send(JSON.stringify(e))} catch (a){i(a.name + ": " + a.message)} else if ("GET" === r)try{n.send()} catch (a){i(a)}}, i)}, t.exports = o}, function(t, e){"use strict"; t.exports.envVars = {dataCollectorUrl:"https://collector.schibsted.io/api/v1/track", userServiceUrl:"https://cis.schibsted.com/api/v1/identify", errorReportingUrl:""}}, function(t, e){"use strict"; t.exports.envVars = {dataCollectorUrl:"http://127.0.0.1:8002/api/v1/track", userServiceUrl:"https://cis.schibsted.com/api/v1/identify", errorReportingUrl:""}}, function(t, e){"use strict"; function i(t, e, i){this.collectorBaseUrl = t, this.service = e || "pulse2", this.clientId = "", this.pageViewId = "", this.throttle = .1, i >= 0 && (this.throttle = i)}i.prototype.initPulsePixel = function(t, e){this.clientId = e, this.pageViewId = t, this.collectorBaseUrl = this.getImageTrackingUrl(this.collectorBaseUrl), this.createPulsePixelUrl(), this.initPixel()}, i.prototype.initPixel = function(){Math.random() < this.throttle && this.collectorBaseUrl && this.injectPixel()}, i.prototype.createPulsePixelUrl = function(){var t = "?provider.@id=" + this.clientId; t += "&service=" + this.service, t += "&@type=Pixel", t += "&@id=" + this.pageViewId, this.collectorBaseUrl += t}, i.prototype.injectPixel = function(){var t = this.createImgElement(), e = document.getElementsByTagName("body"); e.item(0).appendChild(t)}, i.prototype.getImageTrackingUrl = function(t){var e = "", i = /\/api\/v[0-9]\/track$/; try{e = t.replace(i, "/img")} catch (o){return}return t !== e && e?e:void 0}, i.prototype.createImgElement = function(){var t = document.createElement("img"); return t.src = this.collectorBaseUrl, t.id = this.service + "pixel", t.style.visibility = "hidden", t}, t.exports = i}, function(t, e, i){"use strict"; function o(t){if (!t)throw new Error("size of the queue must be given"); this.maxSize = t, this.queue = []}var n = i(13); o.prototype.push = function(t){this.queue.push(t), this.queue.length > this.maxSize && this.queue.shift()}, o.prototype.pushMany = function(t){if (!n.isArray(t))throw new Error("elements must be an array"); this.queue = this.queue.concat(t), this.queue.length > this.maxSize && (this.queue = this.queue.slice(this.queue.length - this.maxSize, this.queue.length))}, o.prototype.pull = function(){return this.queue.shift()}, o.prototype.pullAll = function(){return this.queue.splice(0, this.queue.length)}, o.prototype.peek = function(){return this.queue[0]}, o.prototype.peekAll = function(){return this.queue}, o.prototype.count = function(){return this.queue.length}, t.exports = o}, function(t, e, i){"use strict"; function o(t){this.opts = t, this.plugins = window.pulse2plugins || [], this.hooks = {eventCreated:this.plugins.eventCreatedHooks || [], eventReady:this.plugins.eventReadyHooks || [], eventSent:this.plugins.eventSentHooks || [], load:this.plugins.onLoadHooks || [], ready:this.plugins.onReadyHooks || []}, this.sdkReady = "ready", this.sdkLoad = "load", this.eventCreated = "eventCreated", this.eventReady = "eventReady", this.eventSent = "eventSent"}var n = i(13); o.prototype.call = function(t, e){switch (t){case this.eventCreated:case this.eventReady:case this.eventSent:return this.callEventHooks(e, this.hooks[t]); case this.sdkReady:case this.sdkLoad:return this.callSdkHooks(e, this.hooks[t]); default:return}}, o.prototype.callEventHooksArray = function(t, e){var i, o = []; for (i = 0; i < t.length; i++)o.push(this.callEventHooks(t[i], e)); return o}, o.prototype.callEventHooks = function(t, e){var i, o, r, s; if (e = e || [], n.isArray(t))return this.callEventHooksArray(t, e); if (!t["@type"])return t; for (s = 0; s < e.length; s++)if (i = e[s], o = n.objectKeys(i)[0].toLowerCase(), "all" === o || o === t["@type"].toLowerCase())try{r = i[o](t), r && (t = r)} catch (a){this.opts.debugMode && console.log("plugins.js: A pulse2 sdk plugin failed: " + a)}return t}, o.prototype.callSdkHooks = function(t, e){var i; if ("object" == typeof e && "object" == typeof t)for (i = 0; i < e.length; i++)try{e[i](t)} catch (o){this.opts.debugMode && console.log("plugins.js: A pulse2 event plugin failed: " + o)}}, o.prototype.on = function(t, e, i){var o = {}; t && e && (i?o[i] = e:o = e, this.hooks[t].push(o))}, t.exports = o}, function(t, e){"use strict"; function i(t){this.activity = t, this.plugins = this.activity.plugins, this.registerTriggers()}i.prototype.registerTriggers = function(){this.plugins.on(this.plugins.sdkLoad, this.getUrlTriggers)}, i.prototype.getUrlTriggers = function(t){var e, i, o, n, r, s, a = t.utils.getUrlParams("p2param"); for (i = 0; i < a.length; i++){for (s = {}, n = a[i].split("."), o = n.slice(2), r = 0; r < o.length; r++)try{o[r] = o[r].split("_"), s[o[r][0]] = o[r][1]} catch (c){this.activity.opts.debugMode && console.log("trigger.js: An error occurred while reading URL param: " + c)}e = t.events.trackCustomEvent(null, n[0], s), e.data.object.displayName = n[1], e.data.object["@id"] += ":elementId:" + n[1], e.send()}}, t.exports = i}])}); var pulse2config = {
"client": "",
        "config": [
        {
        "throttle": 1,
                "dataCollector": "https://collector.schibsted.io/api/v1/track",
                "cis": "https://cis.schibsted.com/api/v1/identify"
        }
        ]
        }
;